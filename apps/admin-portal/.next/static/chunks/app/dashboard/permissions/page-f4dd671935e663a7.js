(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[102],{10333:(e,t,a)=>{"use strict";a.d(t,{eu:()=>l,q5:()=>i});var s=a(20912);a(34012);var r=a(16560),n=a(87343);function l(e){let{className:t,...a}=e;return(0,s.jsx)(r.bL,{"data-slot":"avatar",className:(0,n.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...a})}function i(e){let{className:t,...a}=e;return(0,s.jsx)(r.H4,{"data-slot":"avatar-fallback",className:(0,n.cn)("bg-muted flex size-full items-center justify-center rounded-full",t),...a})}},22425:(e,t,a)=>{"use strict";a.d(t,{Fi:()=>d,P4:()=>i,YB:()=>o,s:()=>c,su:()=>l});var s=a(43239);let r=e=>new Promise(t=>setTimeout(t,e));async function n(e){let{retries:t=4,baseDelayMs:a=400,maxDelayMs:s=8e3}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=0;for(;;)try{return await e()}catch(m){var l,i,d;let e=null==m||null==(l=m.response)?void 0:l.status,o=function(e){if(!e)return null;let t=Number(e);return Number.isFinite(t)?Math.max(0,t):null}(null==m||null==(d=m.response)||null==(i=d.headers)?void 0:i["retry-after"]);if(!(429===e&&n<t))throw m;let c=null!=o?1e3*o:Math.min(s,Math.round(a*Math.pow(2,n))),u=c*(.4*Math.random()-.2);c=Math.max(200,Math.round(c+u)),await r(c),n+=1;continue}}async function l(){var e,t,a;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2?arguments[2]:void 0,d=arguments.length>3?arguments[3]:void 0,o=function(e,t){let a={};for(let s of t){let t=e[s];null!=t&&(a[s]=t)}return a}({page:r,limit:l,search:(null==i?void 0:i.trim())||void 0},["page","limit","search"]),{data:c}=await n(()=>s.A.get("/modules/getAll",{params:o,signal:null==d?void 0:d.signal}));return{rows:null!=(a=null==c||null==(e=c.data)?void 0:e.modules)?a:[],pagination:null==c||null==(t=c.data)?void 0:t.pagination}}async function i(e){let{data:t}=await n(()=>s.A.get("/modules/getById/".concat(e)));return t.data}async function d(e){let{data:t}=await n(()=>s.A.post("/modules/create",e));return t.data}async function o(e){try{let{data:t}=await n(()=>s.A.post("/modules/update",e));return t.data}catch(a){let{data:t}=await n(()=>s.A.put("/modules/update",e));return t.data}}async function c(e){let{data:t}=await n(()=>s.A.delete("/modules/delete",{data:{id:e}}));return t.data}},24491:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(60080).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},47686:(e,t,a)=>{"use strict";a.d(t,{bq:()=>u,eb:()=>p,gC:()=>m,l6:()=>o,yv:()=>c});var s=a(20912);a(34012);var r=a(45228),n=a(53020),l=a(70686),i=a(13885),d=a(87343);function o(e){let{...t}=e;return(0,s.jsx)(r.bL,{"data-slot":"select",...t})}function c(e){let{...t}=e;return(0,s.jsx)(r.WT,{"data-slot":"select-value",...t})}function u(e){let{className:t,size:a="default",children:l,...i}=e;return(0,s.jsxs)(r.l9,{"data-slot":"select-trigger","data-size":a,className:(0,d.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i,children:[l,(0,s.jsx)(r.In,{asChild:!0,children:(0,s.jsx)(n.A,{className:"size-4 opacity-50"})})]})}function m(e){let{className:t,children:a,position:n="popper",...l}=e;return(0,s.jsx)(r.ZL,{children:(0,s.jsxs)(r.UC,{"data-slot":"select-content",className:(0,d.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...l,children:[(0,s.jsx)(x,{}),(0,s.jsx)(r.LM,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,s.jsx)(h,{})]})})}function p(e){let{className:t,children:a,...n}=e;return(0,s.jsxs)(r.q7,{"data-slot":"select-item",className:(0,d.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...n,children:[(0,s.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(r.VF,{children:(0,s.jsx)(l.A,{className:"size-4"})})}),(0,s.jsx)(r.p4,{children:a})]})}function x(e){let{className:t,...a}=e;return(0,s.jsx)(r.PP,{"data-slot":"select-scroll-up-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(i.A,{className:"size-4"})})}function h(e){let{className:t,...a}=e;return(0,s.jsx)(r.wn,{"data-slot":"select-scroll-down-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(n.A,{className:"size-4"})})}},48924:(e,t,a)=>{"use strict";a.d(t,{Iv:()=>u,LA:()=>p,iP:()=>m,pF:()=>c,pK:()=>x,zA:()=>o});var s=a(43239);let r=e=>new Promise(t=>setTimeout(t,e));async function n(e){let{retries:t=4,baseDelayMs:a=400,maxDelayMs:s=8e3}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=0;for(;;)try{return await e()}catch(m){var l,i,d;let e=null==m||null==(l=m.response)?void 0:l.status,o=function(e){if(null==e)return null;if("number"==typeof e)return e;let t=String(e).trim(),a=Number(t);if(!Number.isNaN(a))return Math.max(0,a);let s=Date.parse(t);return Number.isNaN(s)?null:Math.max(0,Math.ceil((s-Date.now())/1e3))}(null==m||null==(d=m.response)||null==(i=d.headers)?void 0:i["retry-after"]);if(!(429===e&&n<t))throw m;let c=null!=o?1e3*o:Math.min(s,Math.round(a*Math.pow(2,n))),u=c*(.4*Math.random()-.2);c=Math.max(200,Math.round(c+u)),await r(c),n+=1;continue}}function l(e,t){let a={};for(let s of t){let t=e[s];null!=t&&(a[s]=t)}return a}function i(e){return String(e).trim().toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-_]/g,"-").replace(/-+/g,"-")}function d(e){var t,a,s,r;return{id:e.id,moduleId:null!=(s=null!=(a=null!=(t=e.moduleId)?t:e.module_id)?a:e.module&&e.module.id)?s:"",title:e.title,slug:e.slug,description:null!=(r=e.description)?r:void 0,is_active:e.is_active,created_at:e.created_at,updated_at:e.updated_at}}async function o(e,t){var a,r,i,o,c;let u=null!=(i=null==e?void 0:e.page)?i:1,m=Math.min(null!=(o=null==e?void 0:e.limit)?o:10,100),p=null==e?void 0:e.moduleId,{data:x}=await n(()=>s.A.get("/permissions/getAll",{params:l({page:u,limit:m,moduleId:p},["page","limit","moduleId"]),signal:null==t?void 0:t.signal}));return{rows:(null!=(c=null==x||null==(a=x.data)?void 0:a.permissions)?c:[]).map(d),pagination:null==x||null==(r=x.data)?void 0:r.pagination}}async function c(e,t){let a=[],s=1;for(;;){var n;let{rows:l,pagination:i}=await o({page:s,limit:100,moduleId:e},t);if(a.push(...l),!(null!=(n=null==i?void 0:i.hasNext)?n:100===l.length))break;await r(150),s+=1}return a}async function u(e,t){let{data:a}=await n(()=>s.A.get("/permissions/getById/".concat(e),{signal:null==t?void 0:t.signal}));return d(a.data)}async function m(e){var t,a;let r=l({moduleId:e.moduleId,title:null==(t=e.title)?void 0:t.trim(),slug:i(e.slug),description:null==(a=e.description)?void 0:a.trim()},["moduleId","title","slug","description"]);try{let{data:e}=await n(()=>s.A.post("/permissions/create",r));return e.data}catch(t){let{data:e}=await n(()=>s.A.put("/permissions/create",r));return e.data}}async function p(e){var t,a;let r=l({id:e.id,moduleId:e.moduleId,title:null==(t=e.title)?void 0:t.trim(),slug:i(e.slug),description:null==(a=e.description)?void 0:a.trim(),is_active:e.is_active},["id","moduleId","title","slug","description","is_active"]),{data:d}=await n(()=>s.A.put("/permissions/update",r));return d.data}async function x(e){let{data:t}=await n(()=>s.A.delete("/permissions/delete",{data:{id:e}}));return t.data}},62807:(e,t,a)=>{"use strict";a.d(t,{w:()=>l});var s=a(20912);a(34012);var r=a(64356),n=a(87343);function l(e){let{className:t,orientation:a="horizontal",decorative:l=!0,...i}=e;return(0,s.jsx)(r.b,{"data-slot":"separator",decorative:l,orientation:a,className:(0,n.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",t),...i})}},64356:(e,t,a)=>{"use strict";a.d(t,{b:()=>o});var s=a(34012),r=a(73155),n=a(20912),l="horizontal",i=["horizontal","vertical"],d=s.forwardRef((e,t)=>{var a;let{decorative:s,orientation:d=l,...o}=e,c=(a=d,i.includes(a))?d:l;return(0,n.jsx)(r.sG.div,{"data-orientation":c,...s?{role:"none"}:{"aria-orientation":"vertical"===c?c:void 0,role:"separator"},...o,ref:t})});d.displayName="Separator";var o=d},65123:(e,t,a)=>{"use strict";a.d(t,{E:()=>d});var s=a(20912);a(34012);var r=a(47913),n=a(34248),l=a(87343);let i=(0,n.F)("inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:a,asChild:n=!1,...d}=e,o=n?r.DX:"span";return(0,s.jsx)(o,{"data-slot":"badge",className:(0,l.cn)(i({variant:a}),t),...d})}},71546:(e,t,a)=>{"use strict";a.d(t,{A0:()=>l,BF:()=>i,Hj:()=>d,XI:()=>n,nA:()=>c,nd:()=>o});var s=a(20912);a(34012);var r=a(87343);function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:(0,r.cn)("w-full caption-bottom text-sm",t),...a})})}function l(e){let{className:t,...a}=e;return(0,s.jsx)("thead",{"data-slot":"table-header",className:(0,r.cn)("[&_tr]:border-b",t),...a})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("tbody",{"data-slot":"table-body",className:(0,r.cn)("[&_tr:last-child]:border-0",t),...a})}function d(e){let{className:t,...a}=e;return(0,s.jsx)("tr",{"data-slot":"table-row",className:(0,r.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)("th",{"data-slot":"table-head",className:(0,r.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function c(e){let{className:t,...a}=e;return(0,s.jsx)("td",{"data-slot":"table-cell",className:(0,r.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}},76722:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ed});var s=a(20912),r=a(34012),n=a(92292),l=a(7206),i=a(60362),d=a(40566),o=a(24491),c=a(81985),u=a(26831),m=a(15151),p=a(76301),x=a(34478),h=a(95370),f=a(21856),v=a(45082),g=a(65123),j=a(71546),b=a(5255),w=a(10333),y=a(29083),N=a(69982),k=a(70686),A=a(52062),C=a(38272),z=a(96142),I=a(6976),_=a(43571),M=a(64097),S=a(78989),E=a(72149),P=a(83761),R=a(57464),L="Checkbox",[D,T]=(0,I.A)(L),[F,$]=D(L);function B(e){let{__scopeCheckbox:t,checked:a,children:n,defaultChecked:l,disabled:i,form:d,name:o,onCheckedChange:c,required:u,value:m="on",internal_do_not_use_render:p}=e,[x,h]=(0,M.i)({prop:a,defaultProp:null!=l&&l,onChange:c,caller:L}),[f,v]=r.useState(null),[g,j]=r.useState(null),b=r.useRef(!1),w=!f||!!d||!!f.closest("form"),y={checked:x,disabled:i,setChecked:h,control:f,setControl:v,name:o,form:d,value:m,hasConsumerStoppedPropagationRef:b,required:u,defaultChecked:!V(l)&&l,isFormControl:w,bubbleInput:g,setBubbleInput:j};return(0,s.jsx)(F,{scope:t,...y,children:"function"==typeof p?p(y):n})}var H="CheckboxTrigger",O=r.forwardRef((e,t)=>{let{__scopeCheckbox:a,onKeyDown:n,onClick:l,...i}=e,{control:d,value:o,disabled:c,checked:u,required:m,setControl:p,setChecked:x,hasConsumerStoppedPropagationRef:h,isFormControl:f,bubbleInput:v}=$(H,a),g=(0,z.s)(t,p),j=r.useRef(u);return r.useEffect(()=>{let e=null==d?void 0:d.form;if(e){let t=()=>x(j.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[d,x]),(0,s.jsx)(R.sG.button,{type:"button",role:"checkbox","aria-checked":V(u)?"mixed":u,"aria-required":m,"data-state":X(u),"data-disabled":c?"":void 0,disabled:c,value:o,...i,ref:g,onKeyDown:(0,_.mK)(n,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,_.mK)(l,e=>{x(e=>!!V(e)||!e),v&&f&&(h.current=e.isPropagationStopped(),h.current||e.stopPropagation())})})});O.displayName=H;var G=r.forwardRef((e,t)=>{let{__scopeCheckbox:a,name:r,checked:n,defaultChecked:l,required:i,disabled:d,value:o,onCheckedChange:c,form:u,...m}=e;return(0,s.jsx)(B,{__scopeCheckbox:a,checked:n,defaultChecked:l,disabled:d,required:i,onCheckedChange:c,name:r,form:u,value:o,internal_do_not_use_render:e=>{let{isFormControl:r}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O,{...m,ref:t,__scopeCheckbox:a}),r&&(0,s.jsx)(J,{__scopeCheckbox:a})]})}})});G.displayName=L;var K="CheckboxIndicator",U=r.forwardRef((e,t)=>{let{__scopeCheckbox:a,forceMount:r,...n}=e,l=$(K,a);return(0,s.jsx)(P.C,{present:r||V(l.checked)||!0===l.checked,children:(0,s.jsx)(R.sG.span,{"data-state":X(l.checked),"data-disabled":l.disabled?"":void 0,...n,ref:t,style:{pointerEvents:"none",...e.style}})})});U.displayName=K;var q="CheckboxBubbleInput",J=r.forwardRef((e,t)=>{let{__scopeCheckbox:a,...n}=e,{control:l,hasConsumerStoppedPropagationRef:i,checked:d,defaultChecked:o,required:c,disabled:u,name:m,value:p,form:x,bubbleInput:h,setBubbleInput:f}=$(q,a),v=(0,z.s)(t,f),g=(0,S.Z)(d),j=(0,E.X)(l);r.useEffect(()=>{if(!h)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,t=!i.current;if(g!==d&&e){let a=new Event("click",{bubbles:t});h.indeterminate=V(d),e.call(h,!V(d)&&d),h.dispatchEvent(a)}},[h,g,d,i]);let b=r.useRef(!V(d)&&d);return(0,s.jsx)(R.sG.input,{type:"checkbox","aria-hidden":!0,defaultChecked:null!=o?o:b.current,required:c,disabled:u,name:m,value:p,form:x,...n,tabIndex:-1,ref:v,style:{...n.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function V(e){return"indeterminate"===e}function X(e){return V(e)?"indeterminate":e?"checked":"unchecked"}J.displayName=q;var Z=a(87343);function Y(e){let{className:t,...a}=e;return(0,s.jsx)(G,{"data-slot":"checkbox",className:(0,Z.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,s.jsx)(U,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current transition-none",children:(0,s.jsx)(k.A,{className:"size-3.5"})})})}var W=a(47686),Q=a(97636),ee=a(62807);let et=["create","read","update","delete","readAll"];function ea(e){let{open:t,onOpenChange:a,modules:n,onCreate:i,editMode:d=!1,editValue:o=null,onSave:c}=e,[u,m]=r.useState({}),[p,x]=r.useState({create:!1,read:!1,update:!1,delete:!1,readAll:!1}),[f,j]=r.useState(""),[b,w]=r.useState([]),[y,z]=r.useState(o);r.useEffect(()=>{t||(m({}),x({create:!1,read:!1,update:!1,delete:!1,readAll:!1}),j(""),w([]),z(null))},[t]),r.useEffect(()=>z(null!=o?o:null),[o]);let I=()=>{let e=f.trim();e&&(b.includes(e)||w(t=>[...t,e]),j(""))},_=Object.values(u).filter(Boolean).length,M=et.filter(e=>p[e]).length+b.length;return d&&y?(0,s.jsx)(A.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(A.Cf,{className:"max-w-lg max-h-[80vh] overflow-y-auto",children:[(0,s.jsxs)(A.c7,{children:[(0,s.jsx)(A.L3,{children:"Edit Permission"}),(0,s.jsx)(A.rr,{children:"Update permission information."})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(C.J,{children:"Permission Name"}),(0,s.jsx)(v.p,{value:y.name,onChange:e=>z({...y,name:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(C.J,{children:"Module"}),(0,s.jsxs)(W.l6,{value:y.moduleId,onValueChange:e=>{let t=n.find(t=>t.id===e);z({...y,moduleId:e,moduleName:t.name})},children:[(0,s.jsx)(W.bq,{children:(0,s.jsx)(W.yv,{placeholder:"Choose module"})}),(0,s.jsx)(W.gC,{children:n.map(e=>(0,s.jsx)(W.eb,{value:e.id,children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(C.J,{children:"Action"}),(0,s.jsx)(v.p,{value:y.action,onChange:e=>z({...y,action:e.target.value}),placeholder:"create / read / update / delete / readAll / custom_key"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(C.J,{children:"Description"}),(0,s.jsx)(Q.T,{value:y.description,onChange:e=>z({...y,description:e.target.value}),rows:3})]})]}),(0,s.jsxs)(A.Es,{children:[(0,s.jsx)(h.$,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,s.jsx)(h.$,{onClick:()=>{y&&c&&(c(y),a(!1))},children:"Save changes"})]})]})}):(0,s.jsx)(A.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(A.Cf,{className:"max-w-lg sm:max-w-2xl max-h-[86vh] overflow-y-auto",children:[(0,s.jsxs)(A.c7,{children:[(0,s.jsx)(A.L3,{children:d?"Edit Permission":"Create New Permissions"}),(0,s.jsx)(A.rr,{children:d?"Update permission information.":"Select modules and actions to auto-generate permissions."})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h4",{className:"font-medium",children:"Select Modules"}),(0,s.jsx)("div",{className:"grid gap-3 sm:grid-cols-2",children:n.map(e=>{let t=!!u[e.id],a=()=>{let t;return t=e.id,m(e=>({...e,[t]:!e[t]}))};return(0,s.jsxs)("div",{role:"button",tabIndex:0,onClick:a,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),a())},className:"rounded-xl border p-4 text-left transition ".concat(t?"border-primary/40 bg-primary/5":"hover:bg-muted/50"),children:[(0,s.jsxs)("div",{className:"mb-1 flex items-center gap-2",children:[(0,s.jsx)(Y,{checked:t,onCheckedChange:a,onClick:e=>e.stopPropagation()}),(0,s.jsx)("span",{className:"font-medium",children:e.name})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]},e.id)})})]}),(0,s.jsx)(ee.w,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"font-medium",children:"Module Permissions"}),(0,s.jsx)("div",{className:"grid grid-cols-5 gap-3",children:et.map(e=>(0,s.jsxs)("label",{className:"flex items-center justify-center gap-2 rounded-lg border px-3 py-2 text-sm capitalize transition ".concat(p[e]?"border-primary/40 bg-primary/5":"hover:bg-muted/50"),children:[(0,s.jsx)(Y,{checked:p[e],onCheckedChange:()=>x(t=>({...t,[e]:!t[e]}))}),"readAll"===e?"Read All":e]},e))}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(C.J,{children:"Add Custom Permission"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.p,{placeholder:"e.g. Export",value:f,onChange:e=>j(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),I())}}),(0,s.jsxs)(h.$,{type:"button",onClick:I,children:[(0,s.jsx)(l.A,{className:"mr-2 h-4 w-4"}),"Add"]})]}),!!b.length&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2 pt-1",children:b.map(e=>(0,s.jsxs)(g.E,{variant:"secondary",className:"gap-1",children:[e,(0,s.jsx)(N.A,{className:"ml-1 h-3.5 w-3.5 cursor-pointer",onClick:()=>w(t=>t.filter(t=>t!==e))})]},e))})]})]}),(0,s.jsxs)(A.Es,{className:"sm:justify-between",children:[(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,s.jsx)("span",{className:"font-medium",children:_})," module(s),"," ",(0,s.jsx)("span",{className:"font-medium",children:M})," action(s) selected"]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(h.$,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,s.jsxs)(h.$,{onClick:()=>{let e=n.filter(e=>u[e.id]),t=[...et.filter(e=>p[e]),...b.map(e=>e.toLowerCase().replace(/\s+/g,"_"))],s=[];for(let a of e)for(let e of t){let t="readAll"===e?"Read All":"create"===e||"read"===e||"update"===e||"delete"===e?e[0].toUpperCase()+e.slice(1):e.replace(/_/g," ");s.push({id:crypto.randomUUID(),name:"".concat(t," ").concat(a.name.replace(/ Management$/i,"")).trim(),moduleId:a.id,moduleName:a.name,action:e,description:"readAll"===e?"Read all items in ".concat(a.name):"Permission to ".concat(t.toLowerCase()," for ").concat(a.name)})}i(s),a(!1)},disabled:!_||!M,children:[(0,s.jsx)(k.A,{className:"mr-2 h-4 w-4"}),"Create"," ",_&&M?_*M:0," ","Permissions"]})]})]})]})})}var es=a(48924),er=a(22425),en=a(65988),el=a(37753);function ei(e,t){var a;return{id:e.id,name:e.title,moduleId:e.moduleId,moduleName:t.get(e.moduleId)||e.moduleId,action:e.slug,description:null!=(a=e.description)?a:""}}function ed(){let[e,t]=r.useState([]),[a,N]=r.useState(new Map),[k,A]=r.useState([]),[C,z]=r.useState(!0),[I,_]=r.useState(""),[M,S]=r.useState(!1),[E,P]=r.useState("create"),[R,L]=r.useState(null),[D,T]=r.useState(1),[F]=r.useState(void 0),$=(0,el.T)(en.c.permissions.list),B=(0,el.T)(en.c.permissions.create),H=(0,el.T)(en.c.permissions.update),O=(0,el.T)(en.c.permissions.delete);r.useEffect(()=>{(async()=>{try{let{rows:e}=await (0,er.su)(1,100),a=e.map(e=>({id:e.id,name:e.title,description:""}));t(a);let s=new Map;a.forEach(e=>s.set(e.id,e.name)),N(s)}catch(t){var e,a;console.error(t),n.oR.error((null==t||null==(a=t.response)||null==(e=a.data)?void 0:e.message)||"Failed to load modules")}})()},[]),r.useEffect(()=>{(async()=>{try{if(z(!0),!$)return void A([]);let{rows:e}=await (0,es.zA)({page:1,limit:1e3,moduleId:F});A(e.map(e=>ei(e,a)))}catch(a){var e,t;console.error(a),n.oR.error((null==a||null==(t=a.response)||null==(e=t.data)?void 0:e.message)||"Failed to load permissions")}finally{z(!1)}})()},[F,a,$]);let G=r.useMemo(()=>{let e=I.trim().toLowerCase();return e?k.filter(t=>{var a;return t.name.toLowerCase().includes(e)||(null!=(a=t.moduleName)?a:"").toLowerCase().includes(e)||t.action.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)}):k},[I,k]),K=Math.max(1,Math.ceil(G.length/7)),U=D>K?K:D,q=0===G.length?0:(U-1)*7,J=0===G.length?0:q+7,V=G.slice(q,J),X=G.length,Z=0===X?0:q+1,Y=0===X?0:Math.min(J,X),W=U>1,Q=U<K;r.useEffect(()=>{T(1)},[I]);let ee=async e=>{try{if(!B)return;for(let t of e)await (0,es.iP)({moduleId:t.moduleId,title:t.name,slug:t.action,description:t.description});n.oR.success("Created ".concat(e.length," permission(s)"));let{rows:t}=await (0,es.zA)({page:1,limit:1e3,moduleId:F});A(t.map(e=>ei(e,a)))}catch(e){var t,s;console.error(e),n.oR.error((null==e||null==(s=e.response)||null==(t=s.data)?void 0:t.message)||"Create failed")}},et=async e=>{try{if(!H)return;let t=await (0,es.Iv)(e.id);L(ei(t,a)),P("edit"),S(!0)}catch(e){var t,s;console.error(e),n.oR.error((null==e||null==(s=e.response)||null==(t=s.data)?void 0:t.message)||"Failed to open permission")}},ed=async e=>{try{if(!H)return;await (0,es.LA)({id:e.id,moduleId:e.moduleId,title:e.name,slug:e.action,description:e.description}),n.oR.success("Permission updated"),A(t=>t.map(t=>t.id===e.id?e:t))}catch(e){var t,a;console.error(e),n.oR.error((null==e||null==(a=e.response)||null==(t=a.data)?void 0:t.message)||"Update failed")}},eo=async e=>{try{if(!O)return;await (0,es.pK)(e),n.oR.success("Permission deleted"),A(t=>t.filter(t=>t.id!==e))}catch(e){var t,a;console.error(e),n.oR.error((null==e||null==(a=e.response)||null==(t=a.data)?void 0:t.message)||"Delete failed")}};return(0,s.jsx)(y.A,{screen:"/dashboard/permissions",mode:"block",children:(0,s.jsxs)("div",{className:"space-y-6 scrollbar-stable",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Permissions"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Manage system permissions and access control"})]}),(0,s.jsxs)(h.$,{className:"gap-2 w-full sm:w-auto",onClick:()=>{B&&(P("create"),L(null),S(!0))},disabled:!B,children:[(0,s.jsx)(l.A,{className:"h-4 w-4"}),"Add Permission"]})]}),(0,s.jsxs)(f.Zp,{className:"shadow-sm",children:[(0,s.jsx)(f.aR,{className:"space-y-3",children:(0,s.jsxs)("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[(0,s.jsx)(f.ZB,{className:"text-xl sm:text-2xl",children:"All Permissions"}),(0,s.jsxs)("div",{className:"relative w-full sm:w-[260px] md:w-[320px] lg:w-[350px] max-w-full",children:[(0,s.jsx)(i.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,s.jsx)(v.p,{placeholder:"Search permissions...",className:"h-9 pl-9 w-full",value:I,onChange:e=>_(e.target.value)})]})]})}),(0,s.jsxs)(f.Wu,{className:"px-3 sm:px-6",children:[(0,s.jsx)("div",{className:"mt-1 rounded-xl border overflow-hidden overflow-x-auto",children:(0,s.jsxs)(j.XI,{className:"min-w-[720px]",children:[(0,s.jsx)(j.A0,{children:(0,s.jsxs)(j.Hj,{className:"bg-gray-200",children:[(0,s.jsx)(j.nd,{className:"w-9 rounded-tl-xl"}),(0,s.jsx)(j.nd,{children:"Permission"}),(0,s.jsx)(j.nd,{children:"Module"}),(0,s.jsx)(j.nd,{children:"Action"}),(0,s.jsx)(j.nd,{children:"Description"}),(0,s.jsx)(j.nd,{className:"w-[120px] text-right rounded-tr-xl",children:"Actions"})]})}),(0,s.jsx)(j.BF,{children:C?(0,s.jsx)(j.Hj,{children:(0,s.jsx)(j.nA,{colSpan:6,className:"p-8 text-center text-muted-foreground",children:"Loading permissionsâ€¦"})}):$?0===V.length?(0,s.jsx)(j.Hj,{children:(0,s.jsx)(j.nA,{colSpan:6,className:"p-8 text-center text-muted-foreground",children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3",children:[(0,s.jsx)(w.eu,{className:"h-16 w-16 border border-dashed border-muted-foreground/30 bg-muted/40",children:(0,s.jsx)(w.q5,{children:(0,s.jsx)(d.A,{className:"h-7 w-7 text-muted-foreground"})})}),(0,s.jsx)("div",{className:"text-sm font-medium text-foreground",children:"No permissions found"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground max-w-xs",children:I?"No permissions match your search. Try changing or clearing the search term.":"You don't have any permissions yet. Generate permissions by selecting modules and actions."})]})})}):V.map((e,t)=>{var a;let r=t===V.length-1;return(0,s.jsxs)(j.Hj,{className:"odd:bg-muted/30 even:bg-white hover:bg-transparent",children:[(0,s.jsx)(j.nA,{children:(0,s.jsx)(o.A,{className:"h-4 w-4 text-muted-foreground"})}),(0,s.jsx)(j.nA,{className:"font-medium ".concat(r?"rounded-bl-xl":""),children:e.name}),(0,s.jsx)(j.nA,{children:e.moduleName}),(0,s.jsx)(j.nA,{children:(a=e.action,(0,s.jsx)(g.E,{variant:"secondary",className:"".concat({create:"bg-emerald-500/10 text-emerald-600",read:"bg-sky-500/10 text-sky-600",update:"bg-amber-500/10 text-amber-600",delete:"bg-red-500/10 text-red-600",readAll:"bg-indigo-500/10 text-indigo-600"}[a]||""," capitalize"),children:"readAll"===a?"read all":a}))}),(0,s.jsx)(j.nA,{className:"text-muted-foreground",children:e.description}),(0,s.jsx)(j.nA,{className:"text-right ".concat(r?"rounded-br-xl":""),children:(0,s.jsxs)(b.rI,{children:[(0,s.jsx)(b.ty,{asChild:!0,children:(0,s.jsx)(h.$,{variant:"ghost",size:"icon",className:"h-8 w-8","aria-label":"More actions",children:(0,s.jsx)(c.A,{className:"h-4 w-4"})})}),(0,s.jsxs)(b.SQ,{align:"end",className:"w-40",children:[H&&(0,s.jsxs)(b._2,{className:"gap-2",onClick:()=>et(e),children:[(0,s.jsx)(u.A,{className:"h-4 w-4"}),"Edit"]}),O&&(0,s.jsxs)(b._2,{className:"gap-2 text-destructive focus:text-destructive",onClick:()=>eo(e.id),children:[(0,s.jsx)(m.A,{className:"h-4 w-4"}),"Delete"]})]})]})})]},e.id)}):(0,s.jsx)(j.Hj,{children:(0,s.jsx)(j.nA,{colSpan:6,className:"p-8 text-center text-muted-foreground",children:"You don't have permission to view permissions."})})})]})}),(0,s.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between mt-4",children:[(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",Z," to ",Y," of ",X," permissions"]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[(0,s.jsxs)(h.$,{variant:"outline",size:"sm",disabled:!W,onClick:()=>{W&&T(e=>e-1)},className:"gap-1",children:[(0,s.jsx)(p.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Previous"})]}),(0,s.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:K},(e,t)=>t+1).map(e=>(0,s.jsx)(h.$,{variant:e===U?"default":"outline",size:"sm",onClick:()=>{e>=1&&e<=K&&T(e)},className:"w-8 h-8 p-0 text-xs",children:e},e))}),(0,s.jsxs)(h.$,{variant:"outline",size:"sm",disabled:!Q,onClick:()=>{Q&&T(e=>e+1)},className:"gap-1",children:[(0,s.jsx)("span",{className:"hidden sm:inline",children:"Next"}),(0,s.jsx)(x.A,{className:"h-4 w-4"})]})]})]})]})]}),(0,s.jsx)(ea,{open:M,onOpenChange:S,modules:e,onCreate:ee,editMode:"edit"===E,editValue:R,onSave:ed})]})})}},93253:(e,t,a)=>{Promise.resolve().then(a.bind(a,76722))},97636:(e,t,a)=>{"use strict";a.d(t,{T:()=>n});var s=a(20912);a(34012);var r=a(87343);function n(e){let{className:t,...a}=e;return(0,s.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}}},e=>{e.O(0,[809,57,292,641,189,290,808,4,358],()=>e(e.s=93253)),_N_E=e.O()}]);